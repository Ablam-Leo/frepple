/* frePPLe 4.0.0
Copyright (C) 2010-2019 by frePPLe bvba

This library is free software; you can redistribute it and/or modify it
under the terms of the GNU Affero General Public License as published
by the Free Software Foundation; either version 3 of the License, or
(at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
General Public License for more details.

You should have received a copy of the GNU Affero General Public
License along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

function BufferFactory(e,t,o,a){function n(e){e&&this.extend(e)}return n.prototype={extend:function(t){angular.forEach(t,function(e,n){switch(n){case"location":e&&!e instanceof a&&(t.location=new a(e));break;case"item":e&&!e instanceof o&&(t.item=new a(e))}}),angular.extend(this,t)},get:function(){var n=this;return e.get(t()+"/api/input/buffer/"+encodeURIComponent(n.name)+"/").then(function(e){return n.extend(e.data),n})},save:function(){var n=this;return e.put(t()+"/api/input/buffer/"+encodeURIComponent(n.name)+"/",n).then(function(e){return n.extend(e.data),n})},remove:function(){var n=this;return e.delete(t()+"/api/input/buffer/"+encodeURIComponent(n.name)+"/").then(function(e){return n})}},n}function DemandFactory(t,o,a,r,i){function e(e){e&&this.extend(e)}return e.prototype={extend:function(t){angular.forEach(t,function(e,n){switch(n){case"due":moment.isMoment(e)||(t.due=moment(e));break;case"pegging":e.forEach(function(e,n){moment.isMoment(e.operationplan.start)||(e.operationplan.start=moment(e.operationplan.start)),moment.isMoment(e.operationplan.end)||(e.operationplan.end=moment(e.operationplan.end))});break;case"problems":e.forEach(function(e,n){moment.isMoment(e.start)||(e.start=moment(e.start)),moment.isMoment(e.end)||(e.end=moment(e.end))});break;case"constraints":e.forEach(function(e,n){moment.isMoment(e.start)||(e.start=moment(e.start)),moment.isMoment(e.end)||(e.end=moment(e.end))});break;case"item":e&&!e instanceof r&&(t.item=new r(e));break;case"location":e&&!e instanceof a&&(t.location=new a(e));break;case"customer":e&&!e instanceof i&&(t.customer=new i(e));break;case"maxlateness":t.maxlateness=e/86400}}),angular.extend(this,t)},getData:function(){var e={name:this.name};void 0!==this.quantity&&(e.quantity=this.quantity);void 0!==this.description&&(e.description=this.description);void 0!==this.category&&(e.category=this.category);void 0!==this.subcategory&&(e.subcategory=this.subcategory);void 0!==this.due&&(e.due=this.due.format("YYYY-MM-DDTHH:mm:ss"));void 0!==this.item&&this.item&&(e.item={name:this.item.name});void 0!==this.location&&this.location&&(e.location={name:this.location.name});void 0!==this.customer&&this.customer&&(e.customer={name:this.customer.name});void 0!==this.minshipment&&(e.minshipment=this.minshipment);void 0!==this.maxlateness&&(e.maxlateness=86400*this.maxlateness);void 0!==this.priority&&(e.priority=this.priority);return e},get:function(){var n=this;return t.get(o()+"/api/input/demand/"+encodeURIComponent(n.name)+"/").then(function(e){return console.log("Demand get '"+n.name+"': ",e.data),n.extend(e.data),n})},save:function(){var n=this;return t.put(o()+"/api/input/demand/"+encodeURIComponent(n.name)+"/",n.getData()).then(function(e){return console.log("Demand save '"+n.name+"': ",e.data),n.extend(e.data),n})},remove:function(){var n=this;return t.delete(o()+"/api/input/demand/"+encodeURIComponent(n.name)+"/").then(function(e){return console.log("Demand delete '"+n.name+"': ",e.data),n.status="closed",n})},quote:function(){var n=this;return t.post(o()+"/quote/quote/",{demands:[n.getData()]}).then(function(e){return console.log("Demand quote '"+n.name+"': ",e.data),n.extend(e.data.demands[0]),n})},cancel:function(){var n=this;return t.post(o()+"/quote/cancel/?name="+encodeURIComponent(n.name)).then(function(e){return console.log("Demand '"+n.name+"' canceled"),n.status="closed",n})},inquiry:function(){var n=this;return n.status="inquiry",t.post(o()+"/quote/inquiry/",{demands:[n.getData()]}).then(function(e){return console.log("Demand inquiry '"+n.name+"': ",e.data),n.extend(e.data.demands[0]),n})},confirm:function(){var n=this;return t.post(o()+"/quote/confirm/?name="+encodeURIComponent(n.name)).then(function(e){return console.log("Demand '"+n.name+"' confirmed"),n.status="confirmed",n})},info:function(e){var n=this;return t.post(o()+"/quote/info/",[n.name]).then(function(e){return console.log("Demand info '"+n.name+"': ",e.data),n.extend(e.data.demands[0]),n})}},e}function CustomerFactory(e,t){function n(e){e&&angular.extend(this,e)}return n.prototype={extend:function(e){angular.extend(this,e)},get:function(){var n=this;return e.get(t()+"/api/input/customer/"+encodeURIComponent(n.name)+"/").then(function(e){return n.extend(e.data),n})},save:function(){var n=this;return e.put(t()+"/api/input/customer/"+encodeURIComponent(n.name)+"/",n).then(function(e){return n.extend(e.data),n})},remove:function(){var n=this;return e.delete(t()+"/api/input/customer/"+encodeURIComponent(n.name)+"/").then(function(e){return n})}},n}function ItemFactory(e,t){function n(e){e&&this.extend(e)}return n.prototype={extend:function(e){angular.extend(this,e)},get:function(){var n=this;return e.get(t()+"/api/input/item/"+encodeURIComponent(n.name)+"/").then(function(e){return n.extend(e.data),n})},save:function(){var n=this;return e.put(t()+"/api/input/item/"+encodeURIComponent(n.name)+"/",n).then(function(e){return n.extend(e.data),n})},remove:function(){var n=this;return e.delete(t()+"/api/input/item/"+encodeURIComponent(n.name)+"/").then(function(e){return n})}},n}function LocationFactory(e,t){function n(e){e&&this.extend(e)}return n.prototype={extend:function(e){angular.extend(this,e)},get:function(){var n=this;return e.get(t()+"/api/input/location/"+encodeURIComponent(n.name)+"/").then(function(e){return n.extend(e.data),n})},save:function(){var n=this;return e.put(t()+"/api/input/location/"+encodeURIComponent(n.name)+"/",n).then(function(e){return n.extend(e.data),n})},remove:function(){var n=this;return e.delete(t()+"/api/input/location/"+encodeURIComponent(n.name)+"/").then(function(e){return n})}},n}function OperationFactory(e,t,o){function n(e){e&&this.extend(e)}return n.prototype={extend:function(t){angular.forEach(t,function(e,n){switch(n){case"location":e&&!e instanceof o&&(t.location=new o(e))}}),angular.extend(this,t)},get:function(){var n=this;return e.get(t()+"/api/input/operation/"+encodeURIComponent(n.name)+"/").then(function(e){return n.extend(e.data),n})},save:function(){var n=this;return e.put(t()+"/api/input/operation/"+encodeURIComponent(n.name)+"/",n).then(function(e){return n.extend(e.data),n})},remove:function(){var n=this;return e.delete(t()+"/api/input/operation/"+encodeURIComponent(n.name)+"/").then(function(e){return n})}},n}function OperationPlanFactory(e,o,a,r,i){function n(e){e&&this.extend(e)}return n.prototype={extend:function(t){angular.forEach(t,function(e,n){switch(n){case"operation":e&&!e instanceof a&&(t.operation=new a(e));break;case"location":e&&!e instanceof r&&(t.demand=new r(e));break;case"item":e&&!e instanceof i&&(t.item=new i(e))}}),angular.extend(this,t)},get:function(n){var t=this;return void 0===t.id?t:e.get(o()+"/operationplan/?reference="+encodeURIComponent(t.id)).then(function(e){return t.extend(e.data[0]),"function"==typeof n&&n(t),t})},save:function(){var n=this;return e.put(o()+"/api/input/operationplan/?reference="+encodeURIComponent(n.name),n).then(function(e){return n.extend(e.data),n})},remove:function(){var n=this;return e.delete(o()+"/api/input/operationplan/?reference="+encodeURIComponent(n.name)).then(function(e){return n})}},n}function ResourceFactory(e,t,o){function n(e){e&&this.extend(e)}return n.prototype={extend:function(t){angular.forEach(t,function(e,n){switch(n){case"location":e&&!e instanceof o&&(t.location=new o(e))}}),angular.extend(this,t)},get:function(){var n=this;return e.get(t()+"/api/input/resource/"+encodeURIComponent(n)+"/").then(function(e){return n.extend(e.data),n})},save:function(){var n=this;return e.put(t()+"/api/input/resource/"+encodeURIComponent(red.name)+"/",n).then(function(e){return n.extend(e.data),n})},remove:function(){var n=this;return e.delete(t()+"/api/input/resource/"+encodeURIComponent(n)+"/").then(function(e){return n})}},n}function ModelService(t,o,a,r,i,u){var c={demands:{},operations:{},items:{},locations:{},buffers:{},resources:{}};return{masterdata:c,load:function(e){for(var n in e.items)c.items[e.items[n].name]=new a(e.items[n]);for(var n in e.operations)c.operations[e.operations[n].name]=new i(e.operations[n]);for(var n in e.demands)c.demands[e.demands[n].name]=new o(e.demands[n]);for(var n in e.locations)c.locations[e.locations[n].name]=new r(e.locations[n]);for(var n in e.buffers)c.buffers[e.buffers[n].name]=new t(e.buffers[n]);for(var n in e.resources)c.resources[e.resources[n].name]=new u(e.resources[n])}}}angular.module("frepple.input",["frepple.common"]),angular.module("frepple.input").factory("Buffer",BufferFactory),BufferFactory.$inject=["$http","getURLprefix","Item","Location"],angular.module("frepple.input").factory("Demand",DemandFactory),DemandFactory.$inject=["$http","getURLprefix","Location","Item","Customer"],angular.module("frepple.input").factory("Customer",CustomerFactory),CustomerFactory.$inject=["$http","getURLprefix"],angular.module("frepple.input").factory("Item",ItemFactory),ItemFactory.$inject=["$http","getURLprefix"],angular.module("frepple.input").factory("Location",LocationFactory),LocationFactory.$inject=["$http","getURLprefix"],angular.module("frepple.input").factory("Operation",OperationFactory),OperationFactory.$inject=["$http","getURLprefix","Location"],angular.module("frepple.input").factory("OperationPlan",OperationPlanFactory),OperationPlanFactory.$inject=["$http","getURLprefix","Operation","Location","Item"],angular.module("frepple.input").factory("Resource",ResourceFactory),ResourceFactory.$inject=["$http","getURLprefix","Location"],angular.module("frepple.input").service("Model",ModelService),ModelService.$inject=["Buffer","Demand","Item","Location","Operation","Resource"];
//# sourceMappingURL=frepple-input.min.js.map